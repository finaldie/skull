#language: c

sudo: enabled

env:
    - CC=gcc CXX=g++
    - CC=clang CXX=clang++

before_install:
    - uname -a
    - cat /etc/issue
    - sudo apt-get update -qq
    - sudo apt-get install autoconf valgrind expect libyaml-dev python-dev python-pip libprotobuf-dev protobuf-compiler libprotobuf-c0-dev protobuf-c-compiler libc-ares-dev
    - sudo pip install --upgrade setuptools pip
    - sudo pip install PyYAML protobuf==2.6.1 pympler WebOb
    - sudo pip freeze
    - gcc --version
    - g++ --version
    - clang --version
    - clang++ --version
    - python --version
    - which python
    - which python-config
    - python-config --includes
    - python2-config --includes
    - pip -V
    - dpkg -l | grep python
    - ls -al /opt/python/2.7.13/
    - ls -al /opt/python/2.7.13/lib
    - ls -al /opt/python/2.7.13/dist-packages
    - ls -al /opt/python/2.7.13/site-packages
    - ls -al /usr/bin | grep python

install: true

before_script: true

script:
    - make -j4 dep
    - sudo make install-dep
    - make debug=true -j4
    - make clean
    - make -j4 disable_jemalloc=true
    - sudo make install
    - make check debug=true

after_success: true

after_script: true

after_failure: false

notifications:
    email:
      - hyzwowtools@gmail.com
